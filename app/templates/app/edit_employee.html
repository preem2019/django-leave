{% extends 'base.html' %}

{% block title %}แก้ไขข้อมูลพนักงาน{% endblock %}

{% block extra_css %}
<style>
    .form-container { max-width: 800px; margin: 0 auto; }
    .form-card { border-radius: 0.75rem; border: none; }
    .form-card .card-header {
        /* ===== START: แก้ไข (เพิ่ม |default) ===== */
        background-color: {{ site_config.color_warning|default:'#ffc107' }};
        /* ===== END: แก้ไข ===== */
        color: #333;
        border-top-left-radius: 0.75rem;
        border-top-right-radius: 0.75rem;
        padding: 1.5rem;
        text-align: center;
    }
    .form-control:focus, .form-select:focus {
        /* ===== START: แก้ไข (เพิ่ม |default) ===== */
        /* (ใช้ #40 ต่อท้าย hex code เพื่อแทนค่า opacity 25%) */
        box-shadow: 0 0 0 0.25rem {{ site_config.color_warning|default:'#ffc107' }}40; 
        border-color: {{ site_config.color_warning|default:'#ffc107' }};
        /* ===== END: แก้ไข ===== */
    }
    .btn-update {
        /* ===== START: แก้ไข (เพิ่ม |default) ===== */
        background-color: {{ site_config.color_warning|default:'#ffc107' }};
        border-color: {{ site_config.color_warning|default:'#ffc107' }};
        /* ===== END: แก้ไข ===== */
        font-weight: 600;
        padding: 0.75rem;
        color: #333;
    }
    /* ===== START: แก้ไข (เปลี่ยนวิธี hover และเพิ่ม |default) ===== */
    .btn-update:hover { 
        background-color: {{ site_config.color_warning|default:'#e0a800' }};
        border-color: {{ site_config.color_warning|default:'#e0a800' }};
        filter: brightness(90%);
    }
    /* ===== END: แก้ไข ===== */
    .input-group-text { background-color: #e9ecef; border: 1px solid #ced4da; min-width: 42px; display: flex; justify-content: center; }
</style>
{% endblock %}

{% block breadcrumb %}
  <a href="{% url 'app:dashboard' %}" class="text-decoration-none text-secondary">Dashboard</a>
  <span class="mx-2">/</span>
  <a href="{% url 'app:employee-list' %}" class="text-decoration-none text-secondary">รายชื่อพนักงาน</a>
  <span class="mx-2">/</span>
  <span class="text-dark">แก้ไขข้อมูล</span>
{% endblock %}

{% block content %}
<div class="form-container">
    <div class="card form-card shadow-lg">
        <div class="card-header">
            <h3><i class="fas fa-user-edit me-2"></i>แก้ไขข้อมูล: {{ form.instance.name }}</h3>
        </div>
        <div class="card-body">
            <form method="post">
                {% csrf_token %}
                
                {% if form.errors %}
                <div class="alert alert-danger text-center">
                    <strong>เกิดข้อผิดพลาด!</strong> กรุณาตรวจสอบข้อมูลอีกครั้ง
                </div>
                {% endif %}

                <h5 class="mb-3">ข้อมูลส่วนตัวและตำแหน่งงาน</h5>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">ชื่อจริง</label>
                        {{ form.first_name }}
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label">นามสกุล</label>
                        {{ form.last_name }}
                    </div>
                </div>

                <div class="mb-3">
                    <label class="form-label">แผนก</label>
                    {{ form.department }}
                </div>
                <div class="mb-3">
                    <label class="form-label">ตำแหน่ง</label>
                    {{ form.position }}
                </div>
                <div class="mb-3">
                    <label class="form-label">บทบาท (Role)</label>
                    {{ form.role }}
                </div>
                
                <hr>
                <h5 class="mb-3">ข้อมูลการติดต่อ</h5>
                <div class="mb-3">
                    <label class="form-label">เบอร์โทรศัพท์</label>
                    {{ form.phone }}
                </div>
                <div class="mb-3">
                    <label class="form-label">อีเมล</label>
                    {{ form.email }}
                </div>
                {# --- ส่วนที่เพิ่มเข้ามา --- #}
                <div class="mb-3">
                    <label class="form-label">Line User ID</label>
                    {{ form.line_user_id }}
                    <small class="form-text text-muted">ใช้สำหรับส่งการแจ้งเตือนผ่าน Line</small>
                </div>
                {# ------------------------- #}
                <div class="d-grid mt-4">
                    <button type="submit" class="btn btn-lg btn-update">
                        <i class="fas fa-save me-2"></i>บันทึกการเปลี่ยนแปลง
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}